<!DOCTYPE html>
<!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Mon Jun 23 2025 20:15:02 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="682b7e84a37f1c21053d0196" data-wf-site="682b7e84a37f1c21053d018d">

<head>
  <meta charset="utf-8">
  <title>FinanceDashboard</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/financedashboard.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script
    type="text/javascript">WebFont.load({ google: { families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic", "Inconsolata:400,700"] } });</script>
  <script
    type="text/javascript">!function (o, c) { var n = c.documentElement, t = " w-mod-"; n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch") }(window, document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>

<body class="body">
  <section class="header_section">
    <div class="navbar-logo-left">
      <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease"
        role="banner" class="navbar-logo-left-container shadow-three w-nav">
        <div class="container">
          <div class="navbar-wrapper">
            <a href="https://finapla.pl/" class="navbar-brand w-nav-brand"><img src="images/finapla.svg" loading="lazy"
                width="160" alt="" class="image-7"></a>
            <nav role="navigation" class="nav-menu-wrapper w-nav-menu">
              <div>
                <ul role="list" class="nav-menu-two w-list-unstyled">
                  <li>
                    <div class="div-block-17"><img src="images/user-icon.svg" loading="lazy" width="20" height="20"
                        alt="" class="image-3">
                      <div class="text-block-3">usermail@onet.pl</div>
                    </div>
                  </li>
                  <li>
                    <div class="nav-divider"></div>
                  </li>
                  <li class="mobile-margin-top-10">
                    <a href="#" class="button-primary w-button">Wyloguj</a>
                  </li>
                </ul>
              </div>
            </nav>
            <div class="menu-button w-nav-button">
              <div class="icon w-icon-nav-menu"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="tabs_section">
    <div class="tabs_wrapper">
      <div data-current="Konfiguracja" data-easing="ease" data-duration-in="300" data-duration-out="100"
        class="tabs w-tabs">
        <div class="tabsmenu tabs-no-scrollbar w-tab-menu">
          <a data-w-tab="Podsumowanie" class="tab-link-tab-2 w-inline-block w-tab-link"><img width="15" height="15"
              alt="" src="images/stats.svg" loading="lazy" class="image-4">
            <div class="text-block-13">Podsumowanie</div>
          </a>
          <a data-w-tab="Konfiguracja" class="tab-link-tab-2 w-inline-block w-tab-link w--current"><img width="15"
              height="15" alt="" src="images/configuration.svg" loading="lazy" class="image-4">
            <div class="text-block-5">Konfiguracja bota</div>
          </a>
          <a data-w-tab="Subskrypcja" class="tab-link-tab-2 w-inline-block w-tab-link"><img width="15" height="15"
              alt="" src="images/sub.svg" loading="lazy" class="image-5">
            <div class="text-block-6">Zarządzaj subskrypcją</div>
          </a>
          <a data-w-tab="Komendy" class="tab-link-tab-2 w-inline-block w-tab-link"><img width="15" height="15" alt=""
              src="images/comands.svg" loading="lazy" class="image-6">
            <div class="text-block-8">Komendy</div>
          </a>
          <a data-w-tab="Ustawienia" class="tab-link-tab-2 ustawieniakonta w-inline-block w-tab-link"><img width="15"
              height="15" alt="" src="images/user-icon.svg" loading="lazy" class="image-6">
            <div class="text-block-15">Ustawienia konta</div>
          </a>
          <a data-w-tab="Pomoc" class="tab-link-tab-2 w-inline-block w-tab-link"><img width="15" height="15" alt=""
              src="images/questionamrk.svg" loading="lazy" class="image-6">
            <div class="text-block-14">Pomoc</div>
          </a>
        </div>
        <div class="tabscontent-withglow w-tab-content">
          <div data-w-tab="Podsumowanie" id="Podsumowanie" class="tab-pane-tab-4 w-tab-pane">
            <div class="statystykimainwrapper">
              <div class="div-block-25">
                <div class="lottie-animation-2" data-w-id="1a5e4810-ef53-d66b-bc11-9c9d68178d30"
                  data-animation-type="lottie" data-src="documents/H9OGuyZB0R-1.json" data-loop="1" data-direction="1"
                  data-autoplay="1" data-is-ix2-target="0" data-renderer="svg" data-default-duration="0"
                  data-duration="3"></div>
                <div class="title2">Podsumowanie</div>
              </div>
              <p class="paragraph">Zobacz ile czasu już oszczędziła Ci finapla!</p>
              <div class="upperstatswrapper">
                <div class="line"></div>
                <div class="statswrapper2">
                  <div class="stat">
                    <div class="stattitle">Oszczędziłeś już około</div>
                    <div class="line"></div>
                    <div class="div-block-18">
                      <div class="statmainnumber"><span id="minutes-saved" class="text-span-8">69 </span><span
                          class="text-span-5">minut</span></div>
                    </div>
                  </div>
                  <div class="stat">
                    <div class="stattitle">Bot finapli wpisał za Ciebie już</div>
                    <div class="line"></div>
                    <div class="div-block-18">
                      <div class="statmainnumber"><span id="uses-count" class="text-span-7">115 </span><span
                          class="text-span-5">wydatków</span></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tabelewrapper" id="wydatki-wrapper">
                <div class="title2">Twoje wydatki</div>
                <p class="paragraph">Tutaj zobaczysz oraz pobierzesz tabelę ze swoimi wydatkami</p>
                <div class="line"></div>
                <div class="listwrapper">
                  <div class="div-block-21"><img sizes="100vw"
                      srcset="images/5968557-p-500.png 500w, images/5968557.png 512w" alt="" src="images/5968557.png"
                      loading="lazy"></div>
                  <div class="div-block-20">
                    <div class="text-block-12">Zobacz wydatki w Google Sheets <span class="text-span-6">(Wymaga konta
                        Google)</span></div>
                  </div>
                  <div class="buttonwrapper">
                    <a href="#" id="open-sheet-button" class="button-seckondary w-button">Otwórz w Google Sheets </a>
                  </div>
                </div>
                <div class="listwrapper">
                  <div class="div-block-21"><img width="34" loading="lazy" alt="" src="images/scv.svg"></div>
                  <div class="div-block-20">
                    <div class="text-block-12">Pobierz Tabelę jako plik .CSV</div>
                  </div>
                  <div class="buttonwrapper">
                    <a href="#" class="button-seckondary w-button" data-export-format="csv">Pobierz
                      tabela.csv</a>

                  </div>
                </div>
                <div class="listwrapper">
                  <div class="div-block-21"><img loading="lazy" src="images/xls.svg" alt=""></div>
                  <div class="div-block-20">
                    <div class="text-block-12">Pobierz Tabelę jako plik .XLS</div>
                  </div>
                  <div class="buttonwrapper">
                    <a href="#" class="button-seckondary w-button" data-export-format="xls">Pobierz
                      tabela.xls</a>
                  </div>
                </div>
                <div class="listwrapper">
                  <div class="div-block-21"><img loading="lazy" src="images/xlsx.svg" alt=""></div>
                  <div class="div-block-20">
                    <div class="text-block-12">Pobierz Tabelę jako plik .XLSX</div>
                  </div>
                  <div class="buttonwrapper">
                    <a href="#" class="button-seckondary w-button" data-export-format="xlsx">Pobierz
                      tabela.xlsx</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div data-w-tab="Konfiguracja" id="Konfiguracja" class="tab-pane-konfiguracja w-tab-pane w--tab-active">
            <section class="config-step-2">
              <div class="edytujbotawrapper">
                <div class="div-block-10"></div>
                <div class="div-block-9">
                  <h1 class="title2 side-2">Aktualizuj lub dodaj więcej botów</h1>
                  <p class="paragraph">Chcesz zmienić konto lub dodać drugie? Kliknij guzik, jeśli trzeba wyślij
                    wiadomość która się pojawi i gotowe!</p>
                  <div class="line-side"></div>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwtgwrapper"><img width="25" height="25" alt="" src="images/Zasób-3.svg"
                      loading="lazy" class="image-2">
                    <div class="text-block-4">Otwórz bota w Telegramie</div>
                  </div>
                  <a href="#" class="submit-button w-button">Aktywuj w Telegramie</a>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwwhatsappwrapper"><img width="30" height="30" alt="" src="images/whastapp.svg"
                      loading="lazy" class="image">
                    <div class="text-block-4">Otwórz bota w Whatsappie</div>
                  </div>
                  <a href="#" class="submit-button w-button">Aktywuj na WhasApp</a>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwtgwrapper"><img width="25" height="25" alt="" src="images/mess.svg" loading="lazy"
                      class="image-2">
                    <div class="text-block-4">Otwórz bota w Messengerze</div>
                  </div>
                  <a href="#" class="submit-button-greyed w-button">dostępne już niedługo</a>
                </div>
              </div>
              <div class="prawiegotowewrapper hidden">
                <div class="div-block-10">
                  <div class="lottie-animation" data-w-id="5751cc3c-fdb2-dc5b-057f-def08acdbfc3"
                    data-animation-type="lottie" data-src="documents/jlugli36yH-1.json" data-loop="1" data-direction="1"
                    data-autoplay="1" data-is-ix2-target="0" data-renderer="svg" data-default-duration="0"
                    data-duration="2"></div>
                </div>
                <div class="prawiegotoweceneterd">
                  <h1 class="heading-4">Prawie gotowe...</h1>
                  <p class="paragraph">Teraz tylko powiąż bota z Twoim ulubionym komunikatorem!</p>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwtgwrapper"><img width="25" height="25" alt="" src="images/Zasób-3.svg"
                      loading="lazy" class="image-2">
                    <div class="text-block-4">Otwórz bota w Telegramie</div>
                  </div>
                  <a href="#" class="submit-button w-button">Aktywuj w Telegramie</a>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwwhatsappwrapper"><img width="30" height="30" alt="" src="images/whastapp.svg"
                      loading="lazy" class="image">
                    <div class="text-block-4">Otwórz bota w Whatsappie</div>
                  </div>
                  <a href="#" class="submit-button w-button">Aktywuj na WhasApp</a>
                </div>
                <div class="telegrambuttonwrapper">
                  <div class="otworzwtgwrapper"><img width="25" height="25" alt="" src="images/mess.svg" loading="lazy"
                      class="image-2">
                    <div class="text-block-4">Otwórz bota w Messengerze</div>
                  </div>
                  <a href="#" class="submit-button-greyed w-button">Niedługo dostępne</a>
                </div>
              </div>
            </section>
          </div>
          <div data-w-tab="Subskrypcja" id="Subskrypcja" class="tab-pane-subskrypcja w-tab-pane">
            <h1 class="title2 side">Zarządzaj swoją subskrypcją</h1>
            <div class="line-side"></div>
            <div class="premiumversion">
              <div class="subscriptionstatuswrapper">
                <div class="wersjawrapper">
                  <div class="div-block-34"><img width="22" loading="lazy" alt="" src="images/crown.svg"
                      class="image-9">
                    <h1 class="heading-5">Wersja Premium</h1>
                  </div>
                </div>
                <div class="subinfowrapper">
                  <div class="subinfocolumn">
                    <div class="linewrapper">
                      <div class="text-block-17">Data rozpoczęcia</div>
                      <div class="text-block-17-copy">12 Maja 2024</div>
                    </div>
                    <div class="linewrapper">
                      <div class="text-block-17">Cena subskrypcji</div>
                      <div class="text-block-17-copy">14,99zł <span class="text-span-10">/ miesiąc</span></div>
                    </div>
                  </div>
                  <div class="subinfocolumn">
                    <div class="linewrapper">
                      <div class="text-block-17">Data następnego naliczenia</div>
                      <div class="text-block-17-copy">12 Czerwca 2024</div>
                    </div>
                    <div class="linewrapper">
                      <div class="text-block-17">Opłacono metodą</div>
                      <div class="text-block-17-copy">Blik</div>
                    </div>
                  </div>
                </div>
                <div class="div-block-35">
                  <a href="#" class="link-2">Anuluj subskrypcję</a>
                </div>
              </div>
            </div>
            <div class="trialversionwrapper">
              <div class="subscriptionstatuswrapper-copy">
                <div class="wersjawrapper-copy">
                  <h1 class="heading-5-copy">Wersja Demo</h1>
                  <div class="div-block-31">
                    <div class="text-block-16">10<span class="text-span-9">/10</span> </div>
                    <div class="text3">wykorzystanych <br>darmowych użyć</div>
                  </div>
                </div>
              </div>
              <div class="div-block-36">
                <h1 class="subtitle">Pozwól finapli wyręczyć Cię w katalogowaniu wydatków...</h1>
                <h1 class="subtitle-copy">...za jedyne 14,99zł!</h1>
                <div class="w-form">
                  <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get" class="form-2"
                    data-wf-page-id="682b7e84a37f1c21053d0196"
                    data-wf-element-id="8fc5ab50-1846-a60f-fb92-a1fc7b728104"><label
                      class="w-checkbox checkbox-field"><input type="checkbox" name="checkbox" id="checkbox"
                        data-name="Checkbox" required="" class="w-checkbox-input checkbox"><span
                        class="checkbox-label w-form-label" for="checkbox">Akceptuję regulamin oraz politykę
                        prywatności</span></label><input type="submit" data-wait="Please wait..."
                      class="submit-button-2 w-button" value="Kup teraz"></form>
                  <div class="w-form-done">
                    <div>Thank you! Your submission has been received!</div>
                  </div>
                  <div class="w-form-fail">
                    <div>Oops! Something went wrong while submitting the form.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div data-w-tab="Komendy" id="Komendy" class="tab-pane-tab-3 w-tab-pane">
            <h1 class="title2 side">Komendy</h1>
            <div class="line-side"></div>
            <div class="komendy">
              <div class="div-block-12">
                <div class="komenda"><span class="komenda">/pomoc</span></div>
              </div>
              <div class="opis">- Wysyła listę wszystkich komand</div>
            </div>
            <div class="komendy">
              <div class="div-block-12">
                <div class="komenda">/podsumowanie</div>
              </div>
              <div class="opis">- Otrzymaj podsumowanie wydatków</div>
            </div>
            <div class="komendy">
              <div class="div-block-12">
                <div class="komenda"><span>/tabela</span></div>
              </div>
              <div class="opis">- Wysyła link do tabeli z finansami</div>
            </div>
          </div>
          <div data-w-tab="Ustawienia" class="tab-pane-tab-5 w-tab-pane">
            <div>
              <h1 class="title2 side">Ustawienia Konta</h1>
              <div class="line-side"></div>
            </div>
            <div class="updateemailwrapper">
              <h1 class="title3">Zaktualizuj adres e-mail</h1>
              <div class="mailuipdateform w-form">
                <form id="email-form-email" name="email-form-email" data-name="Email Form"
                  data-wf-page-id="682b7e84a37f1c21053d0196" data-wf-element-id="224cce17-30a9-9da3-4b84-615a1b80c056">
                  <label for="email" class="field-label">Wpisz nowy adres e-mail</label>
                  <div class="inputwithbuttonwrapper"><input class="text-field w-input" maxlength="256" name="NewEmail"
                      data-name="NewEmail" placeholder="mail@mail.com" type="email" id="NewEmail" required=""></div>
                  <input type="submit" data-wait="Please wait..." class="button-seckondary emailupdate w-button"
                    value="Zmień">
                  <div id="email-update-info" class="info-box" style="margin-top: 10px; font-weight: 500;"></div>
                </form>
              </div>
              <div class="line-side"></div>
            </div>
            <div class="updateemailwrapper">
              <h1 class="title3">Zaktualizuj hasło</h1>
              <div class="passwordupdateform w-form">
                <form id="email-form-password" name="email-form-password" data-name="Email Form" method="get"
                  class="form" data-wf-page-id="682b7e84a37f1c21053d0196"
                  data-wf-element-id="08af812a-45b2-781a-a4d9-067ecf2b0fd7">
                  <label for="email" class="field-label">Wpisz stare hasło</label>
                  <div class="inputwithbuttonwrapper"><input class="text-field w-input" maxlength="256"
                      name="OldPassword" data-name="OldPassword" placeholder="**************" type="password"
                      id="OldPassword" required=""></div>
                  <div class="div-block-28"><label for="NewPassword" class="field-label">Wpisz nowe hasło</label><input
                      class="text-field w-input" maxlength="256" name="NewPassword" data-name="NewPassword"
                      placeholder="**************" type="password" id="NewPassword" required=""></div>
                  <div class="div-block-28"><label for="RepeatPassword" class="field-label">Powtórz nowe
                      hasło</label><input class="text-field w-input" maxlength="256" name="RepeatPassword"
                      data-name="RepeatPassword" placeholder="**************" type="password" id="RepeatPassword"
                      required=""></div><input type="submit" data-wait="Please wait..."
                    class="button-seckondary passwordupdate w-button" value="Zmień">
                  <div id="password-update-info" class="info-box" style="margin-top: 10px; font-weight: 500;"></div>
                </form>
              </div>
            </div>
            <div class="line-side"></div>
            <div class="usunkontowrapper">
              <a href="#" class="link-2">Usuń konto</a>
            </div>
          </div>
          <div data-w-tab="Pomoc" id="Pomoc" class="tab-pane-pomoc w-tab-pane">
            <div class="div-block-29">
              <div class="title2">Potrzebujesz pomocy?</div>
              <p class="paragraph-2">Masz pytania lub napotkałeś problem? Skontaktuj się z naszym zespołem – jesteśmy
                tu, aby Ci pomóc.</p>
              <a href="mailto:support@finapla.pl?subject=Zapytanie%20do%20Supportu%20finapla.pl"
                class="link-block w-inline-block">
                <p class="paragraph-2 link">support@finapla.pl</p>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="div-block-38">
      <a href="#" class="bugreportwrapper w-inline-block">
        <div class="div-block-37"><img src="images/bug.svg" loading="lazy" width="15" alt="" class="image-10">
          <div class="textbugreportbutton">Znalazłeś błąd? Napisz do nas</div>
        </div>
      </a>
    </div>
  </section>
  <section class="footer-dark">
    <div class="container-2">
      <div class="footer-wrapper">
        <a href="https://finapla.pl/" class="footer-brand w-inline-block"><img width="200" height="Auto" alt=""
            src="images/finapla-logo-white.svg" loading="lazy"></a>
        <div class="footer-content">
          <div id="w-node-_3849e9ec-3e1e-f890-6d07-14324250f92c-053d0196" class="footer-block">
            <div class="title-small">Firma</div>
            <a href="#" class="footer-link">Pomoc Techniczna</a>
            <a href="#" class="footer-link">Cennik</a>
          </div>
          <div id="w-node-_3849e9ec-3e1e-f890-6d07-14324250f933-053d0196" class="footer-block">
            <div class="title-small">prawne</div>
            <a href="https://finapla.pl/polityka_prywatnosci" target="_blank" class="footer-link">Polityka
              Prywatności</a>
            <a href="https://finapla.pl/polityka_cookies/" target="_blank" class="footer-link">Polityka Cookies</a>
            <a href="https://finapla.pl/regulamin_uslugi" target="_blank" class="footer-link">Regulamin aplikacji</a>
          </div>
          <div id="w-node-_3849e9ec-3e1e-f890-6d07-14324250f93c-053d0196" class="footer-block">
            <div class="title-small">social media</div>
            <div class="footer-social-block">
              <a href="#" class="footer-social-link w-inline-block"><img loading="lazy"
                  src="https://uploads-ssl.webflow.com/62434fa732124a0fb112aab4/62434fa732124ac15112aad5_twitter%20small.svg"
                  alt="" class="image-8"></a>
              <a href="#" class="footer-social-link w-inline-block"><img loading="lazy"
                  src="https://uploads-ssl.webflow.com/62434fa732124a0fb112aab4/62434fa732124a389912aad8_linkedin%20small.svg"
                  alt=""></a>
              <a href="https://www.facebook.com/finaplapl/" target="_blank"
                class="footer-social-link w-inline-block"><img width="10" loading="lazy" alt=""
                  src="images/facebook.svg"></a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-divider"></div>
    <div class="footer-copyright-center">Copyright © 2025 Cigga Paweł Kostyra. Wszelkie Prawa Zastrzeżone.</div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=682b7e84a37f1c21053d018d"
    type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <style>
    .tabs-no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
      overflow-y: hidden;
    }

    .tabs-no-scrollbar::-webkit-scrollbar {
      display: none;
      height: 0px;
      background: transparent;
    }

    /* 👇 Klasa do ukrywania sekcji */
    .hidden {
      display: none !important;
    }
  </style>
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabase = createClient(
      "https://vptpascqhmpmgnufevks.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdHBhc2NxaG1wbWdudWZldmtzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc2NTcwNDEsImV4cCI6MjA2MzIzMzA0MX0.5Vtk65gjiUG0VrBqbukwikF02SX5z55xV-Ag3U4CGp0"
    );
    document.querySelectorAll(".w-form-done, .w-form-fail").forEach(el => {
      el.style.display = "none";
    }); //  Ukrywamy domyślne Webflowowe komunikaty formularza
    document.addEventListener("DOMContentLoaded", async () => {
      const emailText = document.querySelector(".text-block-3");
      const logoutButton = document.querySelector(".button-primary.w-button");

      const { data: { session } } = await supabase.auth.getSession();

      if (!session?.user) {
        window.location.href = "/logowanie/index.html";
        return;
      }

      const userId = session.user.id;
      const email = session.user.email;

      console.log("📌 Zalogowany userId:", userId);
      console.log("📌 Email użytkownika:", email);
      if (emailText) emailText.innerText = email;

      // 📊 Liczba użyć → do podsumowania
      try {
        let uses = 0;
        const { data: usageRow, error: usageError } = await supabase
          .from("user_config")
          .select("UsesCount")
          .eq("user_id", userId)
          .single();

        if (usageError) {
          console.error("Błąd pobierania UsesCount:", usageError);
        } else {
          uses = usageRow?.UsesCount || 0;
          const minutes = Math.round(uses * 2.67);

          const usesSpan = document.getElementById("uses-count");
          const minutesSpan = document.getElementById("minutes-saved");

          if (usesSpan) usesSpan.textContent = uses;
          if (minutesSpan) minutesSpan.textContent = minutes;
        }
        // 🔟 Wersja Demo – pokazuj X/10 jeśli X < 10
        const demoCountText = document.querySelector(".text-block-16");
        if (demoCountText) {
          const limitedUses = Math.min(uses, 10);
          demoCountText.textContent = `${limitedUses}/10`;
        }


      } catch (err) {
        console.error("Błąd JS przy UsesCount:", err);
      }
      // 🔗 Pokazuj sekcję wydatków tylko jeśli istnieje spreadsheet_link
      const openSheetBtn = document.getElementById("open-sheet-button");
      const wydatkiWrapper = document.getElementById("wydatki-wrapper");

      if (wydatkiWrapper) {
        wydatkiWrapper.classList.add("hidden"); // ukryj domyślnie
      }

      try {
        const { data, error } = await supabase
          .from("user_config")
          .select("spreadsheet_link")
          .eq("user_id", userId)
          .single();

        const link = data?.spreadsheet_link?.trim();

        if (link && wydatkiWrapper) {
          wydatkiWrapper.classList.remove("hidden");

          if (openSheetBtn) {
            openSheetBtn.addEventListener("click", (e) => {
              e.preventDefault();
              window.open(link, "_blank");
            });
          }
        } else {
          console.log("🔒 Brak spreadsheet_link – sekcja ukryta.");
        }
      } catch (err) {
        console.error("❌ Błąd pobierania spreadsheet_link:", err);
      }
      // 🧠 Jeśli user nie istnieje w tabeli `users` – dopisz
      const { data: existingUser } = await supabase
        .from("users")
        .select("user_id")
        .eq("user_id", userId)
        .single();

      if (!existingUser) {
        await supabase.from("users").insert([{
          user_id: userId,
          email: email,
          created_at: new Date().toISOString()
        }]);
      }

      // 🤖 Sprawdzenie botów
      const edytujWrapper = document.querySelector(".edytujbotawrapper");
      const prawieWrapper = document.querySelector(".prawiegotowewrapper");

      try {
        const { data: configRows, error } = await supabase
          .from("user_config")
          .select("telegram_id, WhatsappNr, messenger_id")
          .eq("user_id", userId)
          .limit(1);

        if (error) {
          console.error("Supabase error:", error);
        }

        const configRow = configRows?.[0];
        const hasTelegram = !!configRow?.telegram_id?.trim?.();
        const hasWhatsapp = !!configRow?.WhatsappNr?.trim?.();
        const hasMessenger = !!configRow?.messenger_id?.trim?.();

        const hasAnyBot = hasTelegram || hasWhatsapp || hasMessenger;

        if (hasAnyBot) {
          edytujWrapper?.classList.remove("hidden");
          prawieWrapper?.classList.add("hidden");
        } else {
          edytujWrapper?.classList.add("hidden");
          prawieWrapper?.classList.remove("hidden");
        }
      } catch (err) {
        console.error("Błąd JS podczas sprawdzania botów:", err);
      }

      // 🔘 Telegram
      const telegramBtns = document.querySelectorAll("a.submit-button.w-button");
      telegramBtns.forEach((btn) => {
        const text = btn.textContent.toLowerCase();
        if (text.includes("telegram")) {
          btn.addEventListener("click", (e) => {
            e.preventDefault();
            const botUsername = "Persxfinance_bot";
            const link = `https://t.me/${botUsername}?start=${userId}`;
            window.open(link, "_blank");
          });
        }
      });

      // 🔘 WhatsApp
      const whatsappBtns = document.querySelectorAll("a.submit-button.w-button");
      whatsappBtns.forEach((btn) => {
        const text = btn.textContent.toLowerCase();
        if (text.includes("whasapp")) {
          btn.addEventListener("click", (e) => {
            e.preventDefault();
            const message = encodeURIComponent(`START_${userId}`);
            const link = `https://wa.me/15556535033?text=${message}`;
            window.open(link, "_blank");
          });
        }
      });

      // 💾 Pobieranie danych jako PDF, CSV, XLS, XLSX
      const exportButtons = document.querySelectorAll("[data-export-format]");
      exportButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const format = btn.dataset.exportFormat;
          const url = `https://pawelko.app.n8n.cloud/webhook/840a2962-364c-4f24-b640-3c9e22502c47?user_id=${userId}&format=${format}`;
          fetch(url)
            .then(res => res.blob())
            .then(blob => {
              const a = document.createElement("a");
              a.href = URL.createObjectURL(blob);
              a.download = `wydatki.${format}`; // np. wydatki.csv albo wydatki.pdf
              document.body.appendChild(a);
              a.click();
              a.remove();
              URL.revokeObjectURL(a.href);
            });
        });
      });

      // 🚪 Wylogowanie
      logoutButton?.addEventListener("click", async () => {
        await supabase.auth.signOut();
        window.location.href = "/logowanie/index.html";
      });

      // ✉️ Aktualizacja adresu e-mail
      const updateEmailForm = document.querySelector('form#email-form[name="email-form-email"]'); // formularz zmiany e-maila

      if (updateEmailForm) {
        updateEmailForm.addEventListener("submit", async (e) => {
          e.preventDefault();

          const newEmailInput = document.querySelector("#NewEmail");
          const newEmail = newEmailInput?.value?.trim();

          if (!newEmail) {
            alert("Podaj nowy adres e-mail.");
            return;
          }

          try {
            const { data, error } = await supabase.auth.updateUser({ email: newEmail });

            if (error) {
              alert("❌ Błąd przy zmianie adresu e-mail: " + error.message);
              console.error("Błąd Supabase:", error);
            } else {
              alert("✅ Na nowy adres został wysłany e-mail weryfikacyjny. ⚠️ Zmiana adresu e - mail wymaga potwierdzenia na obecnym i nowym adresie. Sprawdź obie skrzynki!");
              newEmailInput.value = "";
            }
          } catch (err) {
            console.error("❌ Błąd JS:", err);
            alert("Wystąpił nieoczekiwany błąd.");
          }
        });
      }
      // 🔐 Zmiana hasła
      const updatePasswordForm = document.querySelector('form#email-form[name="email-form-password"] .passwordupdateform, .passwordupdateform form');

      if (updatePasswordForm) {
        updatePasswordForm.addEventListener("submit", async (e) => {
          e.preventDefault();

          const oldPasswordInput = document.querySelector("#OldPassword");
          const newPasswordInput = document.querySelector("#NewPassword");
          const repeatPasswordInput = document.querySelector("#RepeatPassword");
          const infoBox = document.getElementById("password-update-info");

          const oldPassword = oldPasswordInput?.value.trim();
          const newPassword = newPasswordInput?.value.trim();
          const repeatPassword = repeatPasswordInput?.value.trim();

          // Proste walidacje
          if (!oldPassword || !newPassword || !repeatPassword) {
            infoBox.textContent = "❗Uzupełnij wszystkie pola.";
            infoBox.style.color = "red";
            return;
          }

          if (newPassword.length < 6) {
            infoBox.textContent = "❗Nowe hasło musi mieć min. 6 znaków.";
            infoBox.style.color = "red";
            return;
          }

          if (newPassword !== repeatPassword) {
            infoBox.textContent = "❗Nowe hasła się nie zgadzają.";
            infoBox.style.color = "red";
            return;
          }

          try {
            // Supabase nie wymaga starego hasła, ale my sprawdzimy login dla pewności
            const { data: { session }, error: sessionError } = await supabase.auth.getSession();

            const email = session?.user?.email;

            const { error: loginError } = await supabase.auth.signInWithPassword({
              email,
              password: oldPassword,
            });

            if (loginError) {
              infoBox.textContent = "❌ Błędne stare hasło.";
              infoBox.style.color = "red";
              return;
            }

            // Zmieniamy hasło
            const { error } = await supabase.auth.updateUser({ password: newPassword });

            if (error) {
              infoBox.textContent = "❌ Błąd przy zmianie hasła: " + error.message;
              infoBox.style.color = "red";
            } else {
              infoBox.textContent = "✅ Hasło zostało zmienione!";
              infoBox.style.color = "limegreen";
              oldPasswordInput.value = "";
              newPasswordInput.value = "";
              repeatPasswordInput.value = "";
            }
          } catch (err) {
            console.error("Błąd zmiany hasła:", err);
            infoBox.textContent = "❌ Wystąpił nieoczekiwany błąd.";
            infoBox.style.color = "red";
          }
        });
      }
    });
  </script>
  <script type="module">
    const tabMenu = document.querySelector(".w-tab-menu");

    if (!tabMenu) return;

    const observer = new MutationObserver(() => {
      const activeTab = tabMenu.querySelector(".w--current");
      if (activeTab) {
        activeTab.scrollIntoView({
          behavior: "smooth",
          inline: "center",
          block: "nearest"
        });
      }
    });

    observer.observe(tabMenu, {
      subtree: true,
      attributes: true,
      attributeFilter: ["class"]
    });
  </script>
</body>

</html>