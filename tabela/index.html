<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8" />
    <title>Tabela Finapla</title>
    <link href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
    <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
</head>

<body>
    <div id="wrapper">
        <p>Ładowanie danych...</p>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const userId = params.get("user_id");

        fetch(`https://pawelko.app.n8n.cloud/webhook-test/get-table?user_id=${userId}`)
            .then(res => res.json())
            .then(data => {
                if (!data || data.length === 0) {
                    document.getElementById("wrapper").innerHTML = "Brak danych";
                    return;
                }

                const columns = Object.keys(data[0]);
                new gridjs.Grid({
                    columns,
                    data: data.map(row => columns.map(col => row[col])),
                    search: true,
                    sort: true,
                    pagination: { limit: 10 },
                    language: {
                        search: { placeholder: 'Szukaj...' },
                        pagination: {
                            previous: 'Poprzednia',
                            next: 'Następna',
                            showing: 'Pokazuje',
                            results: () => 'wyników'
                        }
                    }
                }).render(document.getElementById("wrapper"));
            });
    </script>
</body>

</html>